library(readxl)
library(tidyverse)
library(tibble)

##### Set working directory 
setwd("C:/Users/lynchba2/National Institutes of Health/Gichimu, Julia (NIH OD) [E] - Data Analysis/DSCA Brown Bag") 

###################### IMPORT DATA INTO R STUDIO ###################### Briana Test

#####Importing Sheet with All RCDC Categories 
FY2019<- read_xlsx("C:/Users/lynchba2/National Institutes of Health/Gichimu, Julia (NIH OD) [E] - Data Analysis/DSCA Brown Bag/PS_Trend_2020EX.xlsx")

######Importing Sheet with Disease Category Global ID 
Global_ID <- read_xlsx("C:/Users/lynchba2/National Institutes of Health/Gichimu, Julia (NIH OD) [E] - Data Analysis/DSCA Brown Bag/Mark.xlsx")

######Import Sheet with RCDC Automated Categories 
RCDC_Automated <- read_xlsx("C:/Users/lynchba2/National Institutes of Health/Gichimu, Julia (NIH OD) [E] - Data Analysis/DSCA Brown Bag/Andrei.xlsx")
#Changing the name of the first column
names(RCDC_Automated)[names(RCDC_Automated) == "Categories"] = "All_Categories"


############# CREATE DATAFRAME 

###### Merge ALL Cateogories sheet to Global ID sheet -  by Categorical name 
FY19 <- merge(FY2019, Global_ID, by = "Categories", all.x = TRUE)

##### Merge new dataframe with all categories and global ID to sheet with RCDC_Automated categories
df2019 <- merge(FY19, RCDC_Automated, by = "Global_ID", all.y = TRUE)  (all.x = True - retains daya 
#Reorder the DF by the "NEW updated 2019 Categorical name"
df2019F <- df2019[order(df2019$All_Categories),]
df2019F[is.na(df2019F)]<- 0

